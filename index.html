<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mini Game</title>

  <style>
    :root{
      color-scheme: dark;
      --bg0:#05050a;
      --bg1:#0a0a14;
      --card: rgba(14,14,24,.62);
      --card2: rgba(10,10,18,.55);
      --stroke: rgba(255,255,255,.08);
      --stroke2: rgba(255,255,255,.12);
      --text:#fff;
      --muted:#a8a8c2;
      --accent:#b28cff;
      --accent2:#72d6ff;
      --good:#7cffbf;
      --bad:#ff6b8a;
      --shadow: 0 18px 70px rgba(0,0,0,.58);
      --r: 22px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--text);
      min-height:100vh;
      background:
        radial-gradient(850px 520px at 10% 10%, rgba(178,140,255,.18), transparent 60%),
        radial-gradient(820px 500px at 90% 15%, rgba(114,214,255,.14), transparent 62%),
        radial-gradient(750px 520px at 30% 88%, rgba(255,107,138,.10), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    /* subtle grain */
    body::before{
      content:"";
      position:fixed; inset:0;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='140' height='140' filter='url(%23n)' opacity='.16'/%3E%3C/svg%3E");
      opacity:.20;
      mix-blend-mode: overlay;
      pointer-events:none;
    }

    .wrap{ max-width: 610px; margin:0 auto; padding:18px; }

    .top{
      display:flex; justify-content:space-between; align-items:center;
      gap:12px;
      margin-bottom:14px;
    }

    .brand{
      display:flex; align-items:center; gap:12px;
      user-select:none;
    }

    .logo{
      width:40px; height:40px; border-radius:14px;
      background: linear-gradient(135deg, rgba(178,140,255,.95), rgba(114,214,255,.85));
      box-shadow: 0 16px 40px rgba(178,140,255,.22);
      position:relative;
      overflow:hidden;
      cursor:pointer;
      flex: 0 0 auto;
    }

    .logo::after{
      content:"";
      position:absolute; inset:-60%;
      background: conic-gradient(from 180deg, transparent, rgba(255,255,255,.16), transparent);
      animation: spin 6.5s linear infinite;
      opacity:.55;
    }
    @keyframes spin{ to { transform: rotate(360deg);} }

    .title b{ display:block; font-size:15px; letter-spacing:.2px; }
    .title span{ display:block; font-size:11px; color:var(--muted); margin-top:2px; }

    .balancePill{
      display:flex; align-items:center; gap:10px;
      padding:10px 12px;
      border-radius: 18px;
      border:1px solid var(--stroke);
      background: rgba(14,14,24,.55);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
    }
    .balancePill .lbl{ font-size:11px; color:var(--muted); }
    .balancePill .val{ font-weight:950; font-size:14px; letter-spacing:.2px; }
    .spark{
      width:10px; height:10px; border-radius:999px;
      background: rgba(114,214,255,.85);
      box-shadow: 0 0 18px rgba(114,214,255,.35);
    }

    .card{
      border-radius: var(--r);
      border:1px solid var(--stroke);
      background: var(--card);
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .tabs{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      padding:14px;
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .tab{
      padding:12px 12px;
      border-radius: 16px;
      border:1px solid var(--stroke);
      background: rgba(10,10,18,.55);
      color:#d7d7f1;
      font-weight:900;
      text-align:center;
      cursor:pointer;
      transition: transform .08s ease, border-color .18s ease, background .18s ease, filter .18s ease;
    }
    .tab:active{ transform: translateY(1px) scale(.995); }
    .tab.active{
      border-color: rgba(178,140,255,.55);
      background: linear-gradient(180deg, rgba(178,140,255,.18), rgba(114,214,255,.10));
      color:#fff;
      filter: brightness(1.06);
    }

    .screen{ padding:14px; }
    .muted{ color:var(--muted); font-size:12px; line-height:1.35; }

    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:12px; }

    .btn{
      width:100%;
      padding:12px 14px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,10,18,.60);
      color:#fff;
      font-weight:950;
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, filter .15s ease, border-color .18s ease, box-shadow .18s ease;
    }
    .btn:hover{
      filter: brightness(1.06);
      border-color: rgba(178,140,255,.33);
      box-shadow: 0 10px 30px rgba(0,0,0,.22);
    }
    .btn:active{ transform: translateY(1px) scale(.995); }
    .btn.primary{
      border-color: rgba(114,214,255,.42);
      background: linear-gradient(135deg, rgba(178,140,255,.22), rgba(114,214,255,.12));
    }
    .btn.danger{
      border-color: rgba(255,107,138,.45);
      background: linear-gradient(135deg, rgba(255,107,138,.16), rgba(10,10,18,.60));
    }

    .log{
      margin-top:10px;
      padding:11px 12px;
      border-radius:16px;
      border:1px solid var(--stroke);
      background: rgba(10,10,18,.55);
      color:#d7d7f1;
      font-size:13px;
      min-height:44px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .dot{
      width:9px; height:9px; border-radius:999px;
      background: rgba(178,140,255,.85);
      box-shadow: 0 0 16px rgba(178,140,255,.30);
    }

    .slotBox{
      margin-top:12px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.06);
      background: var(--card2);
      padding:14px;
    }

    .row{ display:flex; gap:10px; }
    input, textarea{
      width:100%;
      padding:12px 12px;
      border-radius:16px;
      border:1px solid var(--stroke);
      background: rgba(10,10,18,.55);
      color:#fff;
      outline:none;
      font-weight:800;
    }
    input:focus, textarea:focus{ border-color: rgba(178,140,255,.55); }

    .slots{
      display:flex; gap:10px; justify-content:center;
      margin:12px 0 10px;
    }
    .reel{
      width:96px; height:96px;
      border-radius:22px;
      border:1px solid rgba(255,255,255,.08);
      background:
        radial-gradient(90px 70px at 30% 25%, rgba(178,140,255,.20), transparent 60%),
        radial-gradient(90px 70px at 70% 80%, rgba(114,214,255,.14), transparent 60%),
        rgba(10,10,18,.60);
      display:grid; place-items:center;
      font-size:46px;
      box-shadow: 0 18px 44px rgba(0,0,0,.38);
      position:relative;
      overflow:hidden;
      transform: translateZ(0);
    }
    .reel::after{
      content:"";
      position:absolute; inset:-40%;
      background: conic-gradient(from 180deg, transparent, rgba(255,255,255,.08), transparent);
      animation: shine 6.2s linear infinite;
      opacity:.55;
    }
    @keyframes shine{ to{ transform: rotate(360deg);} }

    .shake{ animation: shake .22s ease-in-out 2; }
    @keyframes shake{
      0%{ transform: translateX(0); }
      25%{ transform: translateX(-2px); }
      50%{ transform: translateX(2px); }
      75%{ transform: translateX(-1px); }
      100%{ transform: translateX(0); }
    }

    .tiny{ font-size:11px; color:#7f7f9b; margin-top:10px; text-align:center; }

    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(14,14,24,.75);
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      color:#fff;
      font-weight:900;
      font-size:13px;
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      z-index: 999;
    }
    .toast.show{ opacity:1; transform: translateX(-50%) translateY(-4px); }

    /* Admin modal */
    .modalBack{
      position: fixed; inset:0;
      background: rgba(0,0,0,.58);
      display:none;
      align-items:center; justify-content:center;
      padding:18px;
      z-index: 1000;
    }
    .modal{
      width:100%;
      max-width:560px;
      border-radius: 22px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(14,14,24,.86);
      backdrop-filter: blur(16px);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .modalHead{
      padding:14px 14px;
      display:flex; align-items:center; justify-content:space-between;
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .modalHead b{ font-size:14px; }
    .xbtn{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,10,18,.55);
      color:#fff;
      border-radius: 12px;
      padding:8px 10px;
      cursor:pointer;
      font-weight:950;
    }
    .modalBody{ padding:14px; }
    .kv{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    .hint{
      margin-top:10px;
      padding:10px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(10,10,18,.55);
      font-size:12px;
      color:#d7d7f1;
      line-height:1.35;
    }
    textarea{ min-height: 92px; resize: vertical; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logo" id="logo" title="(–¥–ª—è —Ç–µ–±—è) —É–¥–µ—Ä–∂–∏–≤–∞–π –¥–ª—è –∞–¥–º–∏–Ω–∫–∏"></div>
        <div class="title">
          <b>Mini Game</b>
          <span>–∫–ª–∏–∫–µ—Ä + —Å–ª–æ—Ç—ã ‚Ä¢ —á–∏—Å—Ç–æ —Ñ–∞–Ω</span>
        </div>
      </div>

      <div class="balancePill">
        <div class="spark"></div>
        <div>
          <div class="lbl">–ë–∞–ª–∞–Ω—Å</div>
          <div class="val" id="balance">0</div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="tabs">
        <div class="tab active" id="tabClicker">üí∏ –ó–∞—Ä–∞–±–æ—Ç–æ–∫</div>
        <div class="tab" id="tabSlots">üé∞ –°–ª–æ—Ç—ã</div>
      </div>

      <!-- CLICKER -->
      <div class="screen" id="screenClicker">
        <div class="muted">–¢–∞–ø–∞–π ‚Äî –ø–æ–ª—É—á–∞–π –º–æ–Ω–µ—Ç—ã. –ê–ø–≥—Ä–µ–π–¥ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –¥–æ—Ö–æ–¥ –∑–∞ —Ç–∞–ø.</div>
        <div class="grid">
          <button class="btn primary" id="tapBtn">üí• –¢–∞–ø (+<span id="perTap">1</span>)</button>
          <button class="btn" id="upgradeBtn">‚¨ÜÔ∏è –ê–ø–≥—Ä–µ–π–¥ (+1) ‚Äî <span id="upgradeCost">10</span></button>
        </div>
        <div class="log" id="clickerLog"><span class="dot"></span><span>–ì–æ—Ç–æ–≤.</span></div>
        <div class="tiny">* –í—Å—ë —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.</div>
      </div>

      <!-- SLOTS -->
      <div class="screen" id="screenSlots" style="display:none;">
        <div class="muted">–ö–ª–∞—Å—Å–∏–∫–∞: 3 –±–∞—Ä–∞–±–∞–Ω–∞. –ü–∞—Ä—ã/—Ç—Ä–æ–π–∫–∏ –¥–∞—é—Ç –≤—ã–∏–≥—Ä—ã—à, 7Ô∏è‚É£ ‚Äî —Ç–æ–ø.</div>

        <div class="slotBox">
          <div class="row">
            <input id="bet" type="number" min="1" value="10" />
          </div>
          <div class="muted" style="margin-top:6px;">–°—Ç–∞–≤–∫–∞ (–∏–≥—Ä–æ–≤—ã–µ –º–æ–Ω–µ—Ç—ã)</div>

          <div class="slots">
            <div class="reel" id="r1">üçí</div>
            <div class="reel" id="r2">üçã</div>
            <div class="reel" id="r3">7Ô∏è‚É£</div>
          </div>

          <button class="btn primary" id="spinBtn">üé≤ –ö—Ä—É—Ç–∏—Ç—å</button>
          <div class="log" id="slotsLog"><span class="dot"></span><span>–ì–æ—Ç–æ–≤ –∫ —Å–ø–∏–Ω—É.</span></div>
        </div>

        <div class="tiny">* –≠—Ç–æ –∏–≥—Ä–∞. –ù–∏–∫–∞–∫–∏—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–µ–Ω–µ–≥/–≤—ã–≤–æ–¥–∞.</div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">–û–∫</div>

  <!-- Admin Modal -->
  <div class="modalBack" id="modalBack">
    <div class="modal">
      <div class="modalHead">
        <b>üõ° –ê–¥–º–∏–Ω-–º–µ–Ω—é</b>
        <button class="xbtn" id="closeModal">‚úï</button>
      </div>
      <div class="modalBody">
        <div class="muted">
          –î–ª—è —Ç–µ–±—è: –±–∞–ª–∞–Ω—Å / —É–¥–∞—á–∞ / —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ.  
          (–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–∞—Ä–æ–ª–µ–º.)
        </div>

        <div class="kv">
          <div>
            <div class="muted" style="margin:10px 0 6px;">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å</div>
            <input id="setBalance" type="number" min="0" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä 9999" />
            <button class="btn" style="margin-top:10px;" id="setBalanceBtn">‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
          </div>

          <div>
            <div class="muted" style="margin:10px 0 6px;">–ü–æ–¥–∫—Ä—É—Ç–∏—Ç—å —É–¥–∞—á—É</div>
            <input id="luck" type="number" min="0" max="80" placeholder="0..80 (–≤ %)" />
            <button class="btn" style="margin-top:10px;" id="luckBtn">üçÄ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
          </div>
        </div>

        <div class="grid">
          <button class="btn" id="give1000">üí∏ –í—ã–¥–∞—Ç—å +1000</button>
          <button class="btn danger" id="resetBtn">üß® –°–±—Ä–æ—Å</button>
        </div>

        <div class="hint">
          <b>–≠–∫—Å–ø–æ—Ä—Ç / –∏–º–ø–æ—Ä—Ç</b><br/>
          –ú–æ–∂–µ—à—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç–µ–∫—Å—Ç–æ–º –∏ –ø–æ—Ç–æ–º –≤–µ—Ä–Ω—É—Ç—å.
        </div>

        <div style="margin-top:10px;">
          <textarea id="saveBox" placeholder="—Ç—É—Ç –ø–æ—è–≤–∏—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ..."></textarea>
        </div>

        <div class="grid" style="margin-top:10px;">
          <button class="btn" id="exportBtn">üì§ –≠–∫—Å–ø–æ—Ä—Ç</button>
          <button class="btn" id="importBtn">üì• –ò–º–ø–æ—Ä—Ç</button>
        </div>

        <div class="tiny" id="adminInfo"></div>
      </div>
    </div>
  </div>

  <script>
    // =========================
    // STATE
    // =========================
    const LS_KEY = "mini_game_state_local_v3";
    const ADMIN_PASS = "74739"; // –∫–∞–∫ —Ç—ã –ø—Ä–æ—Å–∏–ª

    const $ = (id) => document.getElementById(id);
    const toastEl = $("toast");

    function toast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add("show");
      setTimeout(()=> toastEl.classList.remove("show"), 1400);
    }

    const state = JSON.parse(localStorage.getItem(LS_KEY) || "{}");
    state.balance ??= 100;
    state.perTap ??= 1;
    state.upgradeCost ??= 10;
    state.luckBoost ??= 0; // 0..80 (%)

    function save(){ localStorage.setItem(LS_KEY, JSON.stringify(state)); }
    function render(){
      $("balance").textContent = state.balance.toString();
      $("perTap").textContent = state.perTap.toString();
      $("upgradeCost").textContent = state.upgradeCost.toString();
      $("adminInfo").textContent = `luckBoost: ${state.luckBoost}% ‚Ä¢ perTap: ${state.perTap} ‚Ä¢ upgradeCost: ${state.upgradeCost}`;
    }

    // =========================
    // TABS
    // =========================
    function setTab(which){
      const clicker = which === "clicker";
      $("tabClicker").classList.toggle("active", clicker);
      $("tabSlots").classList.toggle("active", !clicker);
      $("screenClicker").style.display = clicker ? "" : "none";
      $("screenSlots").style.display = clicker ? "none" : "";
    }
    $("tabClicker").onclick = () => setTab("clicker");
    $("tabSlots").onclick = () => setTab("slots");

    // =========================
    // CLICKER
    // =========================
    const clickerLog = $("clickerLog");
    $("tapBtn").onclick = () => {
      state.balance += state.perTap;
      clickerLog.querySelector("span:last-child").textContent = `+${state.perTap} –º–æ–Ω–µ—Ç ‚úÖ`;
      save(); render();
      if (navigator.vibrate) navigator.vibrate(12);
    };

    $("upgradeBtn").onclick = () => {
      if (state.balance < state.upgradeCost) {
        clickerLog.querySelector("span:last-child").textContent = `–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç. –ù—É–∂–Ω–æ ${state.upgradeCost}.`;
        toast("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–æ–Ω–µ—Ç");
        return;
      }
      state.balance -= state.upgradeCost;
      state.perTap += 1;
      state.upgradeCost = Math.floor(state.upgradeCost * 1.6);
      clickerLog.querySelector("span:last-child").textContent = `–ê–ø–≥—Ä–µ–π–¥ üî• –¢–µ–ø–µ—Ä—å +${state.perTap}.`;
      save(); render();
      toast("–ê–ø–≥—Ä–µ–π–¥ –∫—É–ø–ª–µ–Ω");
    };

    // =========================
    // SLOTS
    // =========================
    const symbols = ["üçí","üçã","üçá","üçâ","üîî","7Ô∏è‚É£"];
    const r1 = $("r1"), r2 = $("r2"), r3 = $("r3");
    const slotsLog = $("slotsLog");
    const betEl = $("bet");

    function randSym(){ return symbols[Math.floor(Math.random()*symbols.length)]; }

    function payout(a,b,c,bet){
      if (a==="7Ô∏è‚É£" && b==="7Ô∏è‚É£" && c==="7Ô∏è‚É£") return bet * 10;
      if (a===b && b===c) return bet * 5;
      if (a===b || b===c || a===c) return bet * 2;
      return 0;
    }

    function biasedSpin(){
      // luckBoost ‚Äî —à–∞–Ω—Å (–≤ %) –ø–æ–¥—Ç–æ–ª–∫–Ω—É—Ç—å –∫ –ø–∞—Ä–µ/—Ç—Ä–æ–π–∫–µ
      const luck = Math.max(0, Math.min(80, state.luckBoost|0));
      const roll = Math.random() * 100;

      const a = randSym();
      if (roll < luck) {
        const b = a;
        const c = (Math.random() < 0.35) ? a : randSym();
        return [a,b,c];
      }
      return [a, randSym(), randSym()];
    }

    function shakeReels(){
      r1.classList.add("shake"); r2.classList.add("shake"); r3.classList.add("shake");
      setTimeout(()=>{ r1.classList.remove("shake"); r2.classList.remove("shake"); r3.classList.remove("shake"); }, 360);
    }

    $("spinBtn").onclick = () => {
      const bet = Math.max(1, parseInt(betEl.value || "1", 10));
      if (state.balance < bet) {
        slotsLog.querySelector("span:last-child").textContent = "–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–æ–Ω–µ—Ç –Ω–∞ —Å—Ç–∞–≤–∫—É.";
        toast("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–æ–Ω–µ—Ç");
        shakeReels();
        return;
      }

      state.balance -= bet;
      save(); render();

      shakeReels();
      if (navigator.vibrate) navigator.vibrate([10, 20, 10]);

      let ticks = 0;
      const t = setInterval(() => {
        r1.textContent = randSym();
        r2.textContent = randSym();
        r3.textContent = randSym();
        ticks++;
        if (ticks >= 14) {
          clearInterval(t);

          const [a,b,c] = biasedSpin();
          r1.textContent = a; r2.textContent = b; r3.textContent = c;

          const win = payout(a,b,c,bet);
          if (win > 0) {
            state.balance += win;
            slotsLog.querySelector("span:last-child").textContent = `${a}${b}${c} ‚Äî –≤—ã–∏–≥—Ä—ã—à +${win} ‚úÖ`;
            toast(`+${win}`);
          } else {
            slotsLog.querySelector("span:last-child").textContent = `${a}${b}${c} ‚Äî –º–∏–º–æ.`;
          }
          save(); render();
        }
      }, 65);
    };

    // =========================
    // ADMIN (local, for you)
    // Open: long-press on logo (700ms) -> password
    // =========================
    const modalBack = $("modalBack");

    function openAdmin(){
      const pass = prompt("–ê–¥–º–∏–Ω-–ø–∞—Ä–æ–ª—å:");
      if (pass !== ADMIN_PASS) {
        toast("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å");
        return;
      }
      modalBack.style.display = "flex";
      $("saveBox").value = "";
      render();
      toast("–ê–¥–º–∏–Ω –æ—Ç–∫—Ä—ã—Ç");
    }

    let pressTimer = null;
    const logo = $("logo");

    const startPress = () => {
      pressTimer = setTimeout(openAdmin, 700); // long press
    };
    const endPress = () => {
      if (pressTimer) clearTimeout(pressTimer);
      pressTimer = null;
    };

    logo.addEventListener("touchstart", startPress, {passive:true});
    logo.addEventListener("touchend", endPress, {passive:true});
    logo.addEventListener("mousedown", startPress);
    logo.addEventListener("mouseup", endPress);
    logo.addEventListener("mouseleave", endPress);

    $("closeModal").onclick = () => modalBack.style.display = "none";
    modalBack.onclick = (e) => { if (e.target === modalBack) modalBack.style.display = "none"; };

    $("setBalanceBtn").onclick = () => {
      const v = parseInt($("setBalance").value || "0", 10);
      state.balance = Math.max(0, v);
      save(); render();
      toast("–ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª—ë–Ω");
    };

    $("luckBtn").onclick = () => {
      const v = parseInt($("luck").value || "0", 10);
      state.luckBoost = Math.max(0, Math.min(80, v));
      save(); render();
      toast(`–£–¥–∞—á–∞: ${state.luckBoost}%`);
    };

    $("give1000").onclick = () => {
      state.balance += 1000;
      save(); render();
      toast("+1000");
    };

    $("resetBtn").onclick = () => {
      localStorage.removeItem(LS_KEY);
      toast("–°–±—Ä–æ—à–µ–Ω–æ");
      setTimeout(()=> location.reload(), 450);
    };

    $("exportBtn").onclick = () => {
      $("saveBox").value = JSON.stringify(state);
      toast("–≠–∫—Å–ø–æ—Ä—Ç –≥–æ—Ç–æ–≤");
    };

    $("importBtn").onclick = () => {
      try{
        const txt = $("saveBox").value.trim();
        if (!txt) { toast("–í—Å—Ç–∞–≤—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ"); return; }
        const obj = JSON.parse(txt);

        // –º—è–≥–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
        state.balance = Math.max(0, parseInt(obj.balance ?? state.balance, 10));
        state.perTap = Math.max(1, parseInt(obj.perTap ?? state.perTap, 10));
        state.upgradeCost = Math.max(1, parseInt(obj.upgradeCost ?? state.upgradeCost, 10));
        state.luckBoost = Math.max(0, Math.min(80, parseInt(obj.luckBoost ?? state.luckBoost, 10)));

        save(); render();
        toast("–ò–º–ø–æ—Ä—Ç –æ–∫");
      } catch(e){
        toast("–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç");
      }
    };

    render();
  </script>
</body>
  </html>
